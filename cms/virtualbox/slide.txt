# Virtualbox

---

## 什么是Virtualbox？

<p style="text-align:left;">虚拟机是指通过软件模拟一套独立运行的硬件环境，用户可以在这个虚拟硬件环境上运行任何系统。虚拟机中运行的系统与物理主机隔离。</p>

<p style="text-align:left;">Virtualbox 是一个虚拟机软件。</p>

---

## 用途

* 体验各种操作系统环境
* 进行各类操作系统实验
* 相对安全的实验环境
* 充分利用系统资源

--

### 信息安全角度

* 恶意代码检测分析
* 单机模拟攻防环境
* 本地操作系统调试

--

### 软件工程角度

* 多样化网络环境测试
* 多操作系统兼容测试

--

### 计算性能角度

* 基础设施即服务的关键技术
* 独立虚拟主机（阿里云等）

---

## 虚拟机相关概念

* 主机操作系统 (Host OS)
* 客机操作系统 (Guest OS)
* 客机增强件 (Guest Additions)

---

## Virtualbox 功能

* 跨系统移植简单
* 硬件兼容性良好
* 客机增强件方便
* 多代可分支快照

---

## 主要配置

* 虚拟硬盘
* 虚拟网络
* 虚拟内存
* 虚拟CPU

--

### 虚拟硬盘

* 支持多种硬盘格式
  * vdi / vmdk / vhd / hdd
* 主要使用vdi格式
* 支持多种存放方式
  * 动态扩展 / 固定大小 / 多文件

--

### 虚拟网络

||NAT|桥接|内部网络|Host-Only|
|---|---|---|---|---|
|客机->主机|是|是|不|需配置|
|主机->客机|不|是|不|需配置|
|客机->其他主机|是|是|不|需配置|
|其他主机->客机|不|是|不|需配置|
|客机之间|不|是|同网段|是|

--

## 内存与CPU

根据需求和主机配置来分配。

---

## 文件传输

<p style="text-align:left;">安装客机增强件后可用多种形式实现主机与客机之间文件的传输。</p>

--

### 共享文件夹

* 添加 `固定分配` 共享文件夹
* 选择需要共享的文件夹并设置共享名
* 根据需求选择是否`自动挂载`或`只读分配`

<p style="text-align:left;">Windows下使用`映射网络驱动器功能`并映射路`\\vboxsvr\share_name`</p>

<p style="text-align:left;">linux下先创建空文件夹如`/mnt/share`，然后shell中输入命令:</p>

```bash
sudo mount -t vboxsf share_name /mnt/share
```

--

### 其他传输方法

* <b style="color:red">开启拖放功能实现文件拖放</b>
* <b style="color:red">开启复制功能实现文件复制</b>
* <b style="color:red">使用U盘等设备实现文件复制</b>
* 通过开启FTP等服务来实现传输
* 使用windows网络共享实现
* 其他网络通信协议或工具

<i style="text-align:left;color:red;">红色部分依赖客机增强件</i>

---

## 备份及迁移

--

### 快照

* 保存当前客机的系统、文件、运行状态
* 需要时通过恢复快照回到所保存的状态
* 即使虚拟机进行了迁移也能恢复快照
* 所有挂载到虚拟机的磁盘可会被恢复
* 删除快照并不会影响虚拟机当前的状态

--

### 迁移

* 最简单的迁移方式就是直接复制整个文件夹
* 可以使用导出导入功能来迁移虚拟机

---

## 实验注意事项

* 确保隔离
* 勤做快照

--

### 隔离

* 主机操作系统与客机操作系统之间的访问隔离
* 客机操作系统与物理主机所在局域网内其他主机的访问隔离
* 同一台主机上的不同客机操作系统之间的访问隔离
* 默认情况下，实验环境所在操作系统与外界的所有访问完全隔离
  * 文件系统访问
  * 设备访问（USB、串口设备等）
  * 网络访问

--

### 勤做快照

* 通过快照确保出现任何破坏性行为都可以快速恢复

--

### 具体操作

* 实验开始前先进行快照
* 设置网络
  * 不需要联网直接禁用网卡
  * 联网实验s优先级 内部网络>Host-Only>NAT>桥接
* 禁用共享文件夹或改为只读共享
* 避免分配USB设备给客机
* 关闭网络共享等其他可能服务

---

## Q & A